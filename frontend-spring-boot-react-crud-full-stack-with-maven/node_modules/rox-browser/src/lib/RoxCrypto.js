import JSEncrypt from 'jsencrypt';
import { sha256 } from 'js-sha256';

class RoxCrypto {
  constructor() {
    this.verifier = new JSEncrypt();
    this.verifier.setPublicKey();
    this.verifier
      .getKey()
      .setPublic(
        'eaf0631114bc9a4150c475c1e5626ecd9c6ac0aa12cfd84ff6ed6db5c9341e8a7eebf05393ffb8c9d0f2e97062f0ff7cc34f9c33209dceb45cb81d6adeda19fbc26b7e6c8f9b6d2ffd90aae6aa4a63023d7e3f09c1e2584469ddbb96894c0aecf9a6eaea8b6d3d93bab9d4831d7ead3f3adecffc19a9f8b04db361788ccb0f6316545189154c098faa09f0c6e5a82596a7fce18d8ed8fd38683c78e70e7dccb10b818347f61a8a5fa486de08fc71deb125d5ba4a979edb1b7609d7285917ebcd93b853dcde977c972fba37a3925a96cd57c526115672827c564f7bf1053d935af15ec5b5b9d8a38563dd702248edf883c430f2413cf0e237d2769eeb6dbdf329',
        '10001'
      );
  }

  verify(payload, signature) {
    return this.verifier.verify(payload, signature, sha256);
  }
}

const instance = new RoxCrypto();

export default instance;
